@using Survey_Feedback_App.Core.Domain.Enum;
@model Survey_Feedback_App.Core.Application.DTOs.ResponseDTO.SurveyFeedbackViewModel

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewData["Title"]</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <h2>@Model.Survey?.Title ?? "Survey Feedback"</h2>

        @if (Model.ShowSurveyForm)
        {
            @using (Html.BeginForm("SubmitFeedback", "Survey", FormMethod.Post))
            {
                @Html.HiddenFor(m => m.Survey.SurveyId)
                @Html.HiddenFor(m => m.Survey.UsersUnregId)

                @for (int i = 0; i < Model.Survey.Questions.Count; i++)
                {
                    <div class="form-group">
                        <label>@Model.Survey.Questions[i].Text</label>
                        @Html.HiddenFor(m => m.Survey.Questions[i].QuestionId)
                        @Html.HiddenFor(m => m.Survey.Questions[i].Type)

                        @if (Model.Survey.Questions[i].Type == Types.Text)
                        {
                            @Html.TextBoxFor(m => m.Survey.Questions[i].Response, new { @class = "form-control" })
                        }
                        else if (Model.Survey.Questions[i].Type == Types.Radio)
                        {
                            @foreach (var option in Model.Survey.Questions[i].Options)
                            {
                                <div class="form-check">
                                    <label class="form-check-label">
                                        @Html.RadioButtonFor(m => m.Survey.Questions[i].Response, option.OptionId, new { @class = "form-check-input" })
                                        @option.Text
                                    </label>
                                </div>
                            }
                        }
                        else if (Model.Survey.Questions[i].Type == Types.Checkbox)
                        {
                            @foreach (var option in Model.Survey.Questions[i].Options)
                            {
                                <div class="form-check">
                                    <label class="form-check-label">
                                        <input type="checkbox" name="Survey.Questions[@i].SelectedOptions" value="@option.OptionId" class="form-check-input" />
                                        @option.Text
                                    </label>
                                </div>
                            }
                        }
                    </div>
                }
                <button type="submit" class="btn btn-primary">Submit</button>
            }
        }
        else
        {
            <div class="alert alert-danger">@Model.ErrorMessage</div>
        }
    </div>
</body>
</html>
